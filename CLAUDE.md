# CLAUDE.md

Documentation-only repo (no application code): OpenAPI spec (YAML) + Mintlify docs (MDX).
Grid is an API for global payments across fiat, stablecoins, and Bitcoin.

## Critical Rules

- **Edit OpenAPI in `openapi/`** — never edit the root `openapi.yaml` directly (it's generated by bundling)
- Run `make build` after any OpenAPI changes to rebundle
- Run `make lint` before committing
- **Mintlify CLI must be version 4.2.284** — newer versions (e.g., 4.2.312) have a bug where API reference pages render blank. Install with `npm install -g mintlify@4.2.284 --force`
- **Requires Node.js v20 or v22** — Mintlify does not support Node 25+. If needed: `export PATH="/opt/homebrew/opt/node@22/bin:$PATH"`
- Use snippets from `mintlify/snippets/` instead of duplicating content across use cases
- Follow writing standards in `mintlify/CLAUDE.md` for all documentation content
- MDX files require frontmatter with `title` and `description`
- React hooks (`useState`, `useEffect`, etc.) work in MDX. If the acorn parser throws, it's usually a JS expression issue (e.g., template literals in JSX curlies), not the hook itself.

## Commands

```bash
make install        # Install dependencies
make build          # Bundle OpenAPI spec (openapi/ → openapi.yaml + mintlify/openapi.yaml)
make lint           # Lint OpenAPI + markdown + run mint openapi-check
make lint-openapi   # Lint OpenAPI only
make lint-markdown  # Lint markdown only
make mint           # Serve docs locally (cd mintlify && mint dev)
```

## File Structure

```
openapi/                    # Source OpenAPI YAML (edit here)
  openapi.yaml              #   Root spec with $ref references
  paths/                    #   Endpoint definitions by domain
  components/schemas/       #   Reusable schema definitions
  webhooks/                 #   Webhook event definitions
openapi.yaml                # Generated bundle (don't edit)
mintlify/                   # Mintlify documentation (MDX)
  docs.json                 #   Navigation and theme config
  snippets/                 #   Shared MDX snippets (use these to avoid duplication)
  styles/base.css           #   CSS overrides
.redocly.yaml               # Redocly bundler/linter config
```

## OpenAPI

Bundled and linted with Redocly (`@redocly/cli`), configured in `.redocly.yaml`. Lint rules enforce operation descriptions, operation IDs, and security definitions.

## CSS Overrides (mintlify/styles/base.css)

- Tailwind utility classes (e.g., `mb-3.5`) are hard to override even with `!important` — use negative margins on sibling elements as a workaround
- Test selectors with `border: 2px solid red !important` to confirm they match before debugging property conflicts
- Mobile nav is in `#mobile-nav`; modals/portals are in `#headlessui-portal-root`

## Troubleshooting: Blank API Reference Pages

1. Restart dev server: `pkill -f "mint.*dev" && cd mintlify && mint dev`
2. Verify CLI version is 4.2.284
3. Run `cd mintlify && mint openapi-check openapi.yaml`
